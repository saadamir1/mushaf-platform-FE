"use strict";(self.webpackChunkmushaf_platform_fe=self.webpackChunkmushaf_platform_fe||[]).push([[122],{122:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var r=a(43),l=a(216),t=a(729),i=a(621),n=a(579);const o=()=>{var e,s;const{user:a,refreshUser:o,logout:d}=(0,t.A)(),c=(0,l.Zp)(),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),g=(0,r.useRef)(null),[w,x]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[P,C]=(0,r.useState)(""),[S,k]=(0,r.useState)(!1),[F,A]=(0,r.useState)(!1),[D,E]=(0,r.useState)(!1),[T,q]=(0,r.useState)(""),[M,R]=(0,r.useState)({firstName:"",lastName:""}),[_,z]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)(()=>{a&&R({firstName:a.firstName||"",lastName:a.lastName||""})},[a]);const Z=e=>{const{name:s,value:a}=e.target;R(e=>({...e,[s]:a}))},B=e=>{const{name:s,value:a}=e.target;z(e=>({...e,[s]:a}))};return a?(0,n.jsxs)("div",{className:"profile-page",children:[(0,n.jsx)("div",{className:"page-header",children:(0,n.jsx)("h1",{children:"My Profile"})}),(0,n.jsxs)("div",{className:"profile-card",children:[(0,n.jsxs)("div",{className:"profile-header",children:[(0,n.jsxs)("div",{className:"profile-avatar-large",style:{cursor:"pointer",position:"relative"},onClick:()=>{var e;null===(e=g.current)||void 0===e||e.click()},title:"Click to change profile picture",children:[a.profilePicture?(0,n.jsx)("img",{src:a.profilePicture,alt:"Profile",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):(0,n.jsxs)(n.Fragment,{children:[null===(e=a.firstName)||void 0===e?void 0:e.charAt(0),null===(s=a.lastName)||void 0===s?void 0:s.charAt(0)]}),S&&(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.75rem"},children:"Uploading..."})]}),(0,n.jsx)("input",{type:"file",ref:g,onChange:async e=>{var s;const r=null===(s=e.target.files)||void 0===s?void 0:s[0];if(r){k(!0);try{await i.zE.uploadProfilePicture(a.id,r),await o(),N("Profile picture updated!"),setTimeout(()=>N(""),3e3)}catch(n){var l,t;x((null===(l=n.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||"Failed to upload picture")}finally{k(!1),g.current&&(g.current.value="")}}},accept:"image/*",style:{display:"none"}}),(0,n.jsxs)("div",{className:"profile-details",children:[(0,n.jsxs)("h2",{children:[a.firstName," ",a.lastName]}),(0,n.jsx)("p",{children:a.email}),(0,n.jsx)("span",{className:"badge",children:a.role})]})]}),(f||h)&&(0,n.jsx)("div",{className:f?"error-message":"success-message",children:f||h}),(0,n.jsxs)("div",{className:"profile-form-section",children:[(0,n.jsx)("h3",{children:"Edit Profile"}),w&&(0,n.jsx)("div",{className:"error-message",children:w}),j&&(0,n.jsx)("div",{className:"success-message",children:j}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0),x(""),N("");try{await i.Dv.updateProfile({firstName:M.firstName,lastName:M.lastName}),await o(),N("Profile updated successfully!"),setTimeout(()=>N(""),3e3)}catch(r){var s,a;x((null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update profile")}finally{u(!1)}},className:"profile-form",children:[(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"firstName",children:"First Name"}),(0,n.jsx)("input",{type:"text",id:"firstName",name:"firstName",value:M.firstName,onChange:Z,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"lastName",children:"Last Name"}),(0,n.jsx)("input",{type:"text",id:"lastName",name:"lastName",value:M.lastName,onChange:Z,required:!0})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Email Address"}),(0,n.jsx)("input",{type:"email",value:a.email||"",disabled:!0,className:"disabled"}),(0,n.jsx)("small",{children:"Email cannot be changed"})]}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?"Saving...":"Save Changes"})]})]}),(0,n.jsxs)("div",{className:"profile-form-section",children:[(0,n.jsx)("h3",{children:"Change Password"}),b&&(0,n.jsx)("div",{className:"error-message",children:b}),P&&(0,n.jsx)("div",{className:"success-message",children:P}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u(!0),y(""),C(""),_.newPassword!==_.confirmPassword)return y("New passwords do not match"),void u(!1);const s=(a=_.newPassword).length<8?"Password must be at least 8 characters":a.length>32?"Password must not exceed 32 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(a)?null:"Password must contain uppercase, lowercase, and number";var a;if(s)return y(s),void u(!1);try{await i.Dv.changePassword({currentPassword:_.currentPassword,newPassword:_.newPassword}),C("Password changed successfully!"),z({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>C(""),3e3)}catch(t){var r,l;y((null===(r=t.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||"Failed to change password")}finally{u(!1)}},className:"profile-form",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"currentPassword",children:"Current Password"}),(0,n.jsx)("input",{type:"password",id:"currentPassword",name:"currentPassword",value:_.currentPassword,onChange:B,required:!0,placeholder:"Enter current password"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,n.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",value:_.newPassword,onChange:B,required:!0,placeholder:"Min 8 chars, uppercase, lowercase, number"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,n.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:_.confirmPassword,onChange:B,required:!0,placeholder:"Confirm new password"})]}),(0,n.jsx)("button",{type:"submit",className:"btn btn-secondary",disabled:m,children:m?"Changing...":"Change Password"})]})]}),(0,n.jsxs)("div",{className:"profile-form-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"1.5rem"},children:[(0,n.jsx)("h3",{style:{color:"var(--danger-color)"},children:"Danger Zone"}),(0,n.jsx)("p",{style:{color:"var(--gray-color)",marginBottom:"1rem"},children:"Once you delete your account, there is no going back. Please be certain."}),F?(0,n.jsxs)("div",{style:{background:"rgba(220, 53, 69, 0.1)",padding:"1rem",borderRadius:"8px"},children:[(0,n.jsx)("p",{style:{marginBottom:"1rem",fontWeight:"500"},children:"Are you sure? This action cannot be undone."}),T&&(0,n.jsx)("div",{className:"error-message",children:T}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,n.jsx)("button",{className:"btn btn-danger",onClick:async()=>{E(!0),q("");try{await i.Dv.deleteAccount(),d(),c("/")}catch(a){var e,s;q((null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to delete account")}finally{E(!1)}},disabled:D,children:D?"Deleting...":"Yes, Delete My Account"}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>{A(!1),q("")},disabled:D,children:"Cancel"})]})]}):(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>A(!0),children:"Delete My Account"})]})]})]}):(c("/login"),null)}}}]);
//# sourceMappingURL=122.d8903a87.chunk.js.map