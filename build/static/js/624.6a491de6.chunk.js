"use strict";(self.webpackChunkmushaf_platform_fe=self.webpackChunkmushaf_platform_fe||[]).push([[624],{624:(e,n,r)=>{r.r(n),r.d(n,{default:()=>i});var a=r(43),t=r(216),s=r(729),l=r(621),d=r(579);const i=()=>{const{user:e,isAdmin:n}=(0,s.A)(),r=(0,t.Zp)(),[i,o]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(""),[b,p]=(0,a.useState)(""),[g,x]=(0,a.useState)(null),[v,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{e?n||r("/"):r("/login")},[e,n,r]),(0,a.useEffect)(()=>{e&&n&&y()},[e,n]);const y=async()=>{try{u(!0);const e=await l.Dv.getAllUsers();o(e.data.data||[])}catch(e){h("Failed to fetch users")}finally{u(!1)}};return e&&n?(0,d.jsxs)("div",{className:"admin-page",children:[(0,d.jsx)("div",{className:"page-header",children:(0,d.jsx)("h1",{children:"Admin Panel"})}),(0,d.jsxs)("div",{className:"admin-card",children:[(m||b)&&(0,d.jsx)("div",{className:m?"error-message":"success-message",children:m||b}),(0,d.jsx)("h2",{children:"User Management"}),c?(0,d.jsx)("div",{className:"loading-state",children:"Loading users..."}):0===i.length?(0,d.jsx)("div",{className:"empty-state",children:(0,d.jsx)("p",{children:"No users found"})}):(0,d.jsx)("div",{className:"users-table-container",children:(0,d.jsxs)("table",{className:"users-table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"ID"}),(0,d.jsx)("th",{children:"Name"}),(0,d.jsx)("th",{children:"Email"}),(0,d.jsx)("th",{children:"Role"}),(0,d.jsx)("th",{children:"Verified"}),(0,d.jsx)("th",{children:"Actions"})]})}),(0,d.jsx)("tbody",{children:i.map(n=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:n.id}),(0,d.jsx)("td",{children:g===n.id?(0,d.jsxs)("div",{className:"edit-form",children:[(0,d.jsx)("input",{type:"text",defaultValue:n.firstName,id:`firstName-${n.id}`,placeholder:"First Name"}),(0,d.jsx)("input",{type:"text",defaultValue:n.lastName,id:`lastName-${n.id}`,placeholder:"Last Name"}),(0,d.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>{const e=document.getElementById(`firstName-${n.id}`).value,r=document.getElementById(`lastName-${n.id}`).value;(async(e,n,r)=>{try{f(`edit-${e}`),await l.Dv.updateUser(e,{firstName:n,lastName:r}),p("User updated successfully"),o(i.map(a=>a.id===e?{...a,firstName:n,lastName:r}:a)),x(null),setTimeout(()=>p(""),3e3)}catch(s){var a,t;h((null===(a=s.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to update user")}finally{f(null)}})(n.id,e,r)},disabled:v===`edit-${n.id}`,children:"Save"}),(0,d.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:()=>x(null),children:"Cancel"})]}):`${n.firstName} ${n.lastName}`}),(0,d.jsx)("td",{children:n.email}),(0,d.jsx)("td",{children:(0,d.jsxs)("select",{className:"role-select",value:n.role,onChange:r=>(async(n,r)=>{if(n!==e.id)try{f(`role-${n}`),await l.Dv.updateUser(n,{role:r}),p(`User role changed to ${r}`),o(i.map(e=>e.id===n?{...e,role:r}:e)),setTimeout(()=>p(""),3e3)}catch(s){var a,t;h((null===(a=s.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to update role")}finally{f(null)}else h("You cannot change your own role")})(n.id,r.target.value),disabled:v===`role-${n.id}`||n.id===e.id,title:n.id===e.id?"Cannot change your own role":"Change role",children:[(0,d.jsx)("option",{value:"user",children:"User"}),(0,d.jsx)("option",{value:"admin",children:"Admin"})]})}),(0,d.jsx)("td",{children:(0,d.jsx)("span",{className:"status-badge "+(n.isEmailVerified?"verified":"pending"),children:n.isEmailVerified?"Yes":"No"})}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{className:"action-buttons",children:[(0,d.jsx)("button",{className:"btn btn-sm btn-outline",onClick:()=>x(n.id),title:"Edit user",children:"Edit"}),(0,d.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async n=>{if(n!==e.id){if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{f(n),await l.Dv.deleteUser(n),p("User deleted successfully"),o(i.filter(e=>e.id!==n)),setTimeout(()=>p(""),3e3)}catch(t){var r,a;h((null===(r=t.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to delete user")}finally{f(null)}}else h("You cannot delete your own account")})(n.id),disabled:v===n.id||n.id===e.id,title:n.id===e.id?"Cannot delete yourself":"Delete user",children:v===n.id?"...":"Delete"})]})})]},n.id))})]})})]}),(0,d.jsx)("style",{children:"\n                .admin-page {\n                    padding: 2rem 1rem;\n                    max-width: 1400px;\n                    margin: 0 auto;\n                }\n                .admin-card {\n                    background: var(--card-bg);\n                    border: 2px solid var(--border-color);\n                    border-radius: 12px;\n                    padding: 2rem;\n                }\n                .admin-card h2 {\n                    margin: 0 0 1.5rem 0;\n                    color: var(--secondary-color);\n                }\n                .users-table-container {\n                    overflow-x: auto;\n                }\n                .users-table {\n                    width: 100%;\n                    border-collapse: collapse;\n                }\n                .users-table th,\n                .users-table td {\n                    padding: 1rem;\n                    text-align: left;\n                    border-bottom: 1px solid var(--border-color);\n                    vertical-align: middle;\n                }\n                .users-table th {\n                    font-weight: 600;\n                    color: var(--secondary-color);\n                    background: var(--light-color);\n                }\n                .users-table tr:hover {\n                    background: var(--light-color);\n                }\n                .role-select {\n                    padding: 0.375rem 0.75rem;\n                    border: 1px solid var(--border-color);\n                    border-radius: 4px;\n                    background: var(--bg-color);\n                    color: var(--text-color);\n                    font-size: 0.85rem;\n                    cursor: pointer;\n                }\n                .role-select:disabled {\n                    opacity: 0.5;\n                    cursor: not-allowed;\n                }\n                .status-badge {\n                    display: inline-block;\n                    padding: 0.25rem 0.75rem;\n                    border-radius: 4px;\n                    font-size: 0.8rem;\n                    font-weight: 500;\n                }\n                .status-badge.verified {\n                    background: rgba(40, 167, 69, 0.1);\n                    color: #28a745;\n                }\n                .status-badge.pending {\n                    background: rgba(255, 193, 7, 0.1);\n                    color: #ffc107;\n                }\n                .action-buttons {\n                    display: flex;\n                    gap: 0.5rem;\n                }\n                .edit-form {\n                    display: flex;\n                    gap: 0.5rem;\n                    align-items: center;\n                }\n                .edit-form input {\n                    padding: 0.375rem 0.5rem;\n                    border: 1px solid var(--border-color);\n                    border-radius: 4px;\n                    font-size: 0.85rem;\n                    width: 100px;\n                }\n                .loading-state {\n                    text-align: center;\n                    padding: 2rem;\n                    color: var(--gray-color);\n                }\n                .btn-sm {\n                    padding: 0.375rem 0.75rem;\n                    font-size: 0.8rem;\n                }\n                .btn-outline {\n                    background: transparent;\n                    border: 1px solid var(--primary-color);\n                    color: var(--primary-color);\n                    cursor: pointer;\n                    border-radius: 4px;\n                }\n                .btn-outline:hover {\n                    background: var(--primary-color);\n                    color: white;\n                }\n                .btn-outline:disabled {\n                    opacity: 0.5;\n                    cursor: not-allowed;\n                }\n                .btn-primary {\n                    background: var(--primary-color);\n                    color: white;\n                    border: none;\n                    cursor: pointer;\n                    border-radius: 4px;\n                }\n                .btn-primary:hover {\n                    background: var(--primary-dark);\n                }\n                .btn-primary:disabled {\n                    opacity: 0.5;\n                    cursor: not-allowed;\n                }\n            "})]}):null}}}]);
//# sourceMappingURL=624.6a491de6.chunk.js.map